<pre>
<h3>
<a href="https://github.com/zachjs/sv2v" target="_blank">zachjs-sv2v</a>
</h3>
description: Tests imported from utd-sv
should_fail: 0
tags: utd-sv
incdirs: 
top_module: 
files: <a href="../../../../third_party/tests/utd-sv/spu_mast.v.html" target="file-frame">third_party/tests/utd-sv/spu_mast.v</a>


module spu_mast (
	spu_mast_maaddr_addrinc,
	spu_mast_memren,
	spu_mast_stbuf_wen,
	spu_mast_mpa_addrinc,
	spu_mast_streq,
	spu_mast_done_set,
	spu_mactl_iss_pulse_dly,
	mactl_stop,
	streq_ack,
	len_neqz,
	spu_wen_allma_stacks_ok,
	spu_mactl_perr_set,
	spu_mactl_stxa_force_abort,
	se,
	reset,
	rclk
);
	input reset;
	input rclk;
	input se;
	input spu_mactl_iss_pulse_dly;
	input mactl_stop;
	input streq_ack;
	input len_neqz;
	input spu_wen_allma_stacks_ok;
	input spu_mactl_perr_set;
	input spu_mactl_stxa_force_abort;
	output spu_mast_maaddr_addrinc;
	output spu_mast_memren;
	output spu_mast_stbuf_wen;
	output spu_mast_mpa_addrinc;
	output spu_mast_streq;
	output spu_mast_done_set;
	wire spu_mast_st_done;
	wire tr2rdmem_frm_wait4stdrain;
	wire ok_to_signal_cmplt;
	wire start_set;
	wire spu_mast_allow_rdmem;
	wire [1:0] rd_cntr_add;
	wire [1:0] rd_cntr_q;
	wire tr2laststreq_frm_wait4stdrain;
	wire local_kill_abort;
	wire streq_ack_dly;
	dff_s #(1) streq_ack_ff(
		.din(streq_ack),
		.q(streq_ack_dly),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	wire spu_mast_done_wen = ((spu_mast_st_done | local_kill_abort) &amp; mactl_stop);
	wire spu_mast_done_rst = (reset | spu_mactl_iss_pulse_dly);
	wire spu_mast_done_set_q;
	dffre_s #(1) spu_mast_done_ff(
		.din(1&#39;b1),
		.q(spu_mast_done_set_q),
		.en(spu_mast_done_wen),
		.rst(spu_mast_done_rst),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	assign spu_mast_done_set = (spu_mast_done_set_q &amp; ok_to_signal_cmplt);
	wire spu_mast_done_wen_dly;
	dff_s #(1) spu_mast_done_wen_ff(
		.din(spu_mast_done_wen),
		.q(spu_mast_done_wen_dly),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	dffre_s #(1) spu_mast_done_stack_ff(
		.din(1&#39;b1),
		.q(spu_mast_done_set_stack),
		.en(spu_mast_done_wen_dly),
		.rst(spu_mast_done_rst),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	assign ok_to_signal_cmplt = (spu_wen_allma_stacks_ok &amp; spu_mast_done_set_stack);
	wire state_reset = (reset | local_kill_abort);
	dff_s #(1) idle_state_ff(
		.din(nxt_idle_state),
		.q(cur_idle_state),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	dffr_s #(1) rdmem_state_ff(
		.din(nxt_rdmem_state),
		.q(cur_rdmem_state),
		.rst(state_reset),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	dffr_s #(1) wait4stdrain_state_ff(
		.din(nxt_wait4stdrain_state),
		.q(cur_wait4stdrain_state),
		.rst(state_reset),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	dffr_s #(1) laststreq_state_ff(
		.din(nxt_laststreq_state),
		.q(cur_laststreq_state),
		.rst(state_reset),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	wire start_stop = (spu_mactl_iss_pulse_dly &amp; mactl_stop);
	assign spu_mast_st_done = ((((cur_wait4stdrain_state &amp; (~ len_neqz)) &amp; rd_cntr_q[0]) | cur_laststreq_state) &amp; streq_ack);
	assign nxt_idle_state = ((state_reset | spu_mast_st_done) | (cur_idle_state &amp; (~ start_stop)));
	wire tr2rdmem_frm_idle = (cur_idle_state &amp; start_stop);
	wire dly_tr2rdmem_frm_idle;
	dff_s #(1) dly_tr2rdmem_frm_idle_ff(
		.din(tr2rdmem_frm_idle),
		.q(dly_tr2rdmem_frm_idle),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	assign tr2rdmem_frm_wait4stdrain = ((cur_wait4stdrain_state &amp; (streq_ack | spu_mast_allow_rdmem)) &amp; len_neqz);
	assign nxt_rdmem_state = (dly_tr2rdmem_frm_idle | tr2rdmem_frm_wait4stdrain);
	assign nxt_wait4stdrain_state = (cur_rdmem_state | (cur_wait4stdrain_state &amp; (~ (streq_ack | (spu_mast_allow_rdmem &amp; len_neqz)))));
	assign tr2laststreq_frm_wait4stdrain = (((cur_wait4stdrain_state &amp; streq_ack) &amp; (~ len_neqz)) &amp; (~ rd_cntr_q[0]));
	assign nxt_laststreq_state = (tr2laststreq_frm_wait4stdrain | (cur_laststreq_state &amp; (~ streq_ack)));
	wire tr2laststreq_frm_wait4stdrain_dly;
	dff_s #(1) tr2laststreq_frm_wait4stdrain_ff(
		.din(tr2laststreq_frm_wait4stdrain),
		.q(tr2laststreq_frm_wait4stdrain_dly),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	assign spu_mast_maaddr_addrinc = cur_rdmem_state;
	assign spu_mast_memren = (cur_rdmem_state &amp; (~ local_kill_abort));
	wire cur_rdmem_state_dly;
	dff_s #(1) cur_rdmem_state_ff(
		.din(cur_rdmem_state),
		.q(cur_rdmem_state_dly),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	wire cur_rdmem_state_dly2;
	wire cur_rdmem_state_dly3;
	dff_s #(2) cur_rdmem_state_dly_ff(
		.din({cur_rdmem_state_dly, cur_rdmem_state_dly2}),
		.q({cur_rdmem_state_dly2, cur_rdmem_state_dly3}),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	assign spu_mast_stbuf_wen = cur_rdmem_state_dly;
	assign spu_mast_streq = (((((((cur_rdmem_state_dly3 &amp; start_set) &amp; (~ rd_cntr_q[1])) | (streq_ack_dly &amp; len_neqz)) | tr2laststreq_frm_wait4stdrain_dly) &amp; (~ cur_idle_state)) &amp; (~ spu_mactl_perr_set)) &amp; (~ spu_mactl_stxa_force_abort));
	assign local_kill_abort = (((((cur_rdmem_state_dly3 &amp; start_set) &amp; (~ rd_cntr_q[1])) | (streq_ack_dly &amp; len_neqz)) | tr2laststreq_frm_wait4stdrain_dly) &amp; (spu_mactl_perr_set | spu_mactl_stxa_force_abort));
	wire tr2rdmem_frm_wait4stdrain_dly;
	dff_s #(1) tr2rdmem_frm_wait4stdrain_ff(
		.din(tr2rdmem_frm_wait4stdrain),
		.q(tr2rdmem_frm_wait4stdrain_dly),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	wire tr2rdmem_frm_wait4stdrain_dly2;
	dff_s #(1) tr2rdmem_frm_wait4stdrain_dly_ff(
		.din(tr2rdmem_frm_wait4stdrain_dly),
		.q(tr2rdmem_frm_wait4stdrain_dly2),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	assign spu_mast_mpa_addrinc = tr2rdmem_frm_wait4stdrain_dly2;
	wire rd_cntr_en = cur_rdmem_state;
	wire rd_cntr_rst = ((state_reset | streq_ack_dly) | start_stop);
	assign rd_cntr_add[1:0] = (rd_cntr_q[1:0] + 2&#39;b01);
	dffre_s #(2) rd_cntr_ff(
		.din(rd_cntr_add[1:0]),
		.q(rd_cntr_q[1:0]),
		.en(rd_cntr_en),
		.rst(rd_cntr_rst),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	dffre_s #(1) start_stop_ff(
		.din(1&#39;b1),
		.q(start_set),
		.en(start_stop),
		.rst((state_reset | streq_ack_dly)),
		.clk(rclk),
		.se(se),
		.si(),
		.so()
	);
	assign spu_mast_allow_rdmem = ((start_set &amp; (~ rd_cntr_q[1])) &amp; cur_rdmem_state_dly3);
endmodule


</pre>